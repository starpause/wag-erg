<project name="WAG ERG Android" basedir="." default="debug-package-android">
	<!-- import project properties -->
	<property file="build-android.properties" />
	
	<!-- FLEX SDK configuration -->
	<property name="mxmlc_path" value="${flex_sdk_dir}/lib/mxmlc.jar" />
	<property name="adt_path" value="${air.sdk.home}/lib/adt.jar" />
	
	<!-- Application configuration -->
	<property name="libs_dir" value="libs" />
	<property name="apk_filename" value="${project.bin}/WagErg.apk"/>
	<property name="android.package.name" value="com.starpause.wagerg"/>
	
	<!-- Compile SWF to build directory for desktop packaging -->
	<target name="compile">
		<java jar="${mxmlc_path}" fork="true" failonerror="true">
			<arg value="-debug=false" />
			<arg value="-optimize=true" />
			<arg value="+flexlib=${flex_sdk_dir}/frameworks" />
			<arg value="+configname=air" />
			<arg value="-file-specs=${main_source}" />
			<arg value="-output=${swf_filename}" />
			<arg value="-l+=${libs_dir}" />
		</java>
	</target>
	
	<target name="debug-package-android">
		<java jar="${adt_path}" fork="true" failonerror="true">    	
			<arg value="-package" />
			<arg value="-target" />
			<arg value="apk" />
			<arg value="-storetype"/>
			<arg value="pkcs12"/>
			<arg value="-keystore" />
			<arg value="${certs_dir}/${self_signed_cert}" />
			<arg value="-storepass"/>
			<arg value="${self_signed_cert_pass}"/>
			<arg value="${apk_filename}" />
			<arg value="${basedir}/config/WagErg-app.xml" />
			<arg value="${project.swf}" />
			<arg value="src/assets/android/icons/"/>
		</java>
	</target>
    
    <target name="debug-deploy-android" depends="debug-package-android,debug-undeploy-android">
		<java jar="${adt_path}" fork="true" failonerror="true">
            <arg value="-installApp" />
            <arg value="-platform" />
            <arg value="android" />
            <arg value="-platformsdk"/>
            <arg value="${android.sdk.home}"/>
            <arg value="-package" />
            <arg value="${apk_filename}" />
        </java>
    </target>
	<!--
	 | It's necessary to uninstall before re-installing an app.
	 |-->
    <target name="debug-undeploy-android">
    	<java jar="${adt_path}" fork="true" failonerror="false">
            <arg value="-uninstallApp" />
            <arg value="-platform" />
            <arg value="android" />
            <arg value="-platformsdk"/>
            <arg value="${android.sdk.home}"/>
            <arg value="-appid" />
            <arg value="${android.package.name}" />
        </java>
    </target>
	
    
</project>